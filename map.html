<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <title>OSM 道路のみマップ</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    html,
    body {
      margin: 0;
      height: 100%;
      background-color: white;
      /* ← これで背景白 */
    }

    #map {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // ---- マップ中心 ----
    const centerLat = 35.568224057746825;
    const centerLon = 139.3988371730611;

    const map = L.map("map").setView([centerLat, centerLon], 16);

    // ---- 背景：白地図（建物なし） ----
    L.tileLayer(
      "https://cyberjapandata.gsi.go.jp/xyz/blank/{z}/{x}/{y}.png",
      {
        maxZoom: 19,
        attribution: "<a href='https://maps.gsi.go.jp/development/'>地理院タイル</a>"
      }
    ).addTo(map);

    // ---- OSM 道路（Overpass API） ----
    const overpassQuery = `
    [out:json][timeout:25];
    (
      way["highway"](around:2000, ${centerLat}, ${centerLon});
    );
    out geom;
  `;

    fetch("https://overpass-api.de/api/interpreter", {
      method: "POST",
      body: overpassQuery
    })
      .then(res => res.json())
      .then(data => {
        data.elements.forEach(el => {
          if (!el.geometry) return;

          const latlngs = el.geometry.map(g => [g.lat, g.lon]);

          // ---- 道路の太さルール ----
          let w = 4;
          if (el.tags.highway === "primary") w = 15;
          else if (el.tags.highway === "secondary") w = 10;
          else if (el.tags.highway === "tertiary") w = 8;
          else if (el.tags.highway === "residential") w = 6;
          else w = 4;

          L.polyline(latlngs, {
            color: "#333",
            weight: w,
            opacity: 1,
          }).addTo(map);
        });
      })
      .catch(err => console.error(err));
  </script>

</body>

</html>